<div class="planning-title">
  <div class="card" style="width: 18rem;">
    <div class="card-body">
      <h5 class="card-title">Planning semaine {{currentWeekNumber}}</h5>
      <h6 class="card-subtitle mb-2 text-muted">du {{weekDays[0]}} au {{weekDays[6]}}</h6>
      <p class="card-text">{{magasinNom}}</p>
    </div>
  </div>
</div>

<div class="btn-action">
  <button class="btn btn-outline-info" (click)="back()"><i class="fas fa-backward"></i> Retour</button>
  <div class="table-actions">
    <button class="btn btn-secondary"><i class="fas fa-print"></i> Imprimer</button>
    <button class="btn btn-primary" (click)="savePlanning()"><i class="fas fa-save"></i> Sauvegarder</button>
  </div>

</div>

<div class="table-responsive">
  <table class="table table-bordered table-striped table-hover">
    <thead>
    <tr>
      <th rowspan="2">Poste</th>
      <th rowspan="2">Employé(e)</th>
      <th rowspan="2">Contrat</th>
      <th colspan="3" *ngFor="let day of weekDays">{{day}}</th>
      <th rowspan="2">Heures planifièes</th>
      <th rowspan="2">Total astreinte</th>
      <th rowspan="2">Coupure</th>
    </tr>
    <tr>
      <ng-container *ngFor="let day of weekDays">
        <td *ngFor="let periode of periodes">{{periode.nom}}</td>
      </ng-container>
    </tr>
    </thead>
    <tbody>
    <ng-container *ngFor="let employee of employees">
      <tr>
        <td rowspan="1">{{employee.poste}}</td>
        <td>{{employee.nomComplet}}</td>
        <td>{{employee.contrat}}h</td>


        <ng-container *ngIf="employee.plannings.length > 0; then planningTemplate else weekTemplate"></ng-container>

        <ng-template #planningTemplate>
          <ng-container *ngFor="let jour of employee.plannings[0].jours">
            <td *ngFor="let periode of jour.periodes">
              <input type="time" value="{{periode.dateDebut}}" disabled/>
              <input type="time" value="{{periode.dateFin}}" disabled/>
            </td>
          </ng-container>
        </ng-template>

        <ng-template #weekTemplate>
          <ng-container *ngFor="let day of weekDays">
            <td *ngFor="let periode of periodes">
              <select #planifier id="{{day + periode.nom + employee.id + magasinId}}"
                      (change)="changeToInputTime(planifier.id, planifier.value, periode, day, employee)">
                <option value="" disabled>...</option>
                <option>SS</option>
                <option>CP</option>
                <option>CRS</option>
                <option>AI</option>
                <option>AJ</option>
                <option>HM</option>
              </select>
            </td>
          </ng-container>
        </ng-template>


        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
    </ng-container>
    </tbody>
  </table>
</div>

